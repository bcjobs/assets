var JOBCENTRE=window.JOBCENTRE||{};JOBCENTRE.renderLocation=function(a){if(!a){return}$.ajax({url:"/admin/dashboard/partials/http_proxy?url="+encodeURIComponent("http://api.ipinfodb.com/v3/ip-city/"),data:{key:"794a606d313d431ea470d4f27e0a36d1ec285191e2d89eba837815499092f9ab",ip:a,format:"json"},cache:true,dataType:"json",success:function(b,e,c){if(b.statusCode!=="OK"){return}var d=[];if(b.cityName){d.push(b.cityName)}if(b.regionName){d.push(b.regionName)}if(b.countryName){d.push(b.countryName)}$("#ip_address").html(a+" ("+d.join(", ")+")")}})};JOBCENTRE.renderFullStory=function(b,a){var c=new XMLHttpRequest();c.open("GET","https://www.fullstory.com/api/v1/sessions?limit=1&uid="+encodeURI("employer-"+b),true);c.setRequestHeader("Content-Type","application/json");c.setRequestHeader("Authorization","Basic "+a);c.withCredentials=true;c.onreadystatechange=function(){if(c.readyState==4){if(c.status==200){var d=JSON.parse(c.responseText);if(!d.length){return}var e=_.template(document.getElementById("fullstory").innerHTML,{userId:d[0].UserId});$("[data-actions]").append(e)}}};c.send()};JOBCENTRE.renderNotes=function(c,b){var a=(function(){var e=false,i=[],h=function(){var j=i.shift();if(j){return g(j)}else{return e=false}},g=function(j){return(j()).always(function(){return h()})},f=function(j){if(e){i.push(j)}else{e=true;g(j)}return j};window.onbeforeunload=function(){if(e){return"Changes are being saved to the server. They may be lost if you leave now."}};return{queue:f}}());var d=function(f){var e=0;while(f.indexOf("**")>=0){f=f.replace("**",++e%2?"<strong>":"</strong>")}$("[data-notes-display]").html(f.replace(/\r?\n/g,"<br />"))};$("body").on("click",'[data-trigger="notes-modal"]',function(){$("body").append(_.template(document.getElementById("notes-modal").innerHTML,{}));$("[data-note-modal]").modal("show").on("shown.bs.modal",function(){$(this).find("input").first().focus()}).on("hidden.bs.modal",function(){$(this).remove();$(".modal-backdrop").remove()})});$("body").on("submit","[data-note-form]",function(f){f.preventDefault();a.queue(function(){return $.ajax({url:"newnote?id="+c,contentType:"application/json",dataType:"json",cache:false,type:"POST",data:JSON.stringify({title:$("input[name=title]").val(),description:$("input[name=description]").val()}),success:function(g,h,e){d(g.notes)},error:function(g,h,e){JOBCENTRE.alertFloater.show({summary:"Error saving note",duration:5000,isError:true})}})});$("[data-note-modal]").modal("hide")});$("#notesSection").append(_.template(document.getElementById("notes").innerHTML,{}));d(b)};JOBCENTRE.renderResumeAuthorize=function(a){$('span[id="ResumeAuthorized"]').append(_.template(document.getElementById("email-authorize").innerHTML,{}));$("input[name=ResumeAuthorized]").change(function(){if($("input[name=ResumeAuthorized]:checked").val()==="0"){$("#sendresumeauthorizedemail_wrapper").find("input[name=SendResumeAuthorizedEmail]").prop("checked",false);$("#sendresumeauthorizedemail_wrapper").hide();return}$("#sendresumeauthorizedemail_wrapper").show();if(!a){$("#sendresumeauthorizedemail_wrapper").find("input[name=SendResumeAuthorizedEmail]").prop("checked",true)}})};JOBCENTRE.renderProvinceNames=function(){var b=_.template($("#province_option").html());var a=[{source:"CountryID",destination:"ProvinceStateID",ajax:null},{source:"BillingCountryID",destination:"BillingProvinceStateID",ajax:null}];_.each(a,function(c){$("#"+c.source).change(function(d){if(c.ajax){c.ajax.abort()}c.ajax=$.ajax({url:"/rest/v1.0/provinces?countryId="+$(this).val(),dataType:"json",type:"GET",success:function(g,h,e){var f=['<option value=""></option>'];_.each(g.data,function(i){f.push(b(i))});$("#"+c.destination).html(f.join(""))},error:function(f,g,e){console.log(e);if(f.statusText==="abort"){return}}})})})};JOBCENTRE.renderCreditCard=function(){$(function(){$("#PaymentMethod").parent().parent().after(_.template($("#creditCardPayment").html()))});$("body").on("change","#PaymentMethod",function(){if($("#PaymentMethod").val()==1){$("[data-cardpayment]").hide();$("#Card_Number").val("")}else{$("[data-cardpayment]").show();$("#CardHoldersName").focus();$("#Card_Number").val("");window.scrollBy(0,150)}})};